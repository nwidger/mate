<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<title>(Deterministic Execution in a Java-like Language)</title>
<meta name="author" content="(Niels Widger)"/>
<link rel="stylesheet" href="./reveal.js/css/reveal.min.css"/>
<link rel="stylesheet" href="./reveal.js/css/theme/night.css" id="theme"/>
<link rel="stylesheet" href="./presentation.css"/>
<link rel="stylesheet" href="./reveal.js/css/print/pdf.css" type="text/css" media="print"/>
<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</head>
<body>
<div class="reveal">
<div class="slides">
<section>
<h1>Deterministic Execution in a Java-like Language</h1>
<h2>Niels Widger</h2>
<h2><a href="mailto:niels.widger@unh.edu">niels.widger@unh.edu</a></h2>
<h2></h2></section>
<section>
<h2>Table of Contents</h2><ul>
<li>
<a href="#sec-1">Thesis</a>
</li>
<li>
<a href="#sec-2">Background</a>
</li>
<li>
<a href="#sec-3">Implementation</a>
</li>
<li>
<a href="#sec-4">Results</a>
</li>
<li>
<a href="#sec-5">Conclusions</a>
</li>
<li>
<a href="#sec-6">Questions?</a>
</li>
</ul>
</section>

<section id="sec-1" >

<h2>Thesis</h2>
<p>
A Java-like programming language can be executed deterministically
using Deterministic Shared Multiprocessing (DMP) with less overhead
than a C-like programming language.
</p>
</section>
<section id="sec-2" >

<h2>Background</h2>
</section>
<section id="sec-2-1" >

<h3>Thread Interleavings</h3>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides" width="100%">


<colgroup>
<col  class="left" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">thread 1</th>
<th scope="col" class="left">thread 2</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left">load count</td>
<td class="left">&#xa0;</td>
</tr>

<tr>
<td class="left">store count</td>
<td class="left">&#xa0;</td>
</tr>

<tr>
<td class="left">&#xa0;</td>
<td class="left">load count</td>
</tr>

<tr>
<td class="left">load count</td>
<td class="left">store count</td>
</tr>

<tr>
<td class="left">store count</td>
<td class="left">&#xa0;</td>
</tr>

<tr>
<td class="left">&#xa0;</td>
<td class="left">load count</td>
</tr>

<tr>
<td class="left">load count</td>
<td class="left">&#xa0;</td>
</tr>

<tr>
<td class="left">store count</td>
<td class="left">&#xa0;</td>
</tr>

<tr>
<td class="left">&#xa0;</td>
<td class="left">store count</td>
</tr>
</tbody>
</table>

<hr  />

<ul class="org-ul">
<li>Source of non-determinism, caused by

<ul class="org-ul">
<li>OS scheduler
</li>

<li>Cache state
</li>

<li>I/O delays
</li>
</ul>
</li>

<li>Could execute threads serially, but we can do better
</li>
</ul>
</section>
<section id="sec-2-2" >

<h3>Communicating Instructions</h3>
<ul class="org-ul">
<li>Load/store instructions to shared memory
</li>

<li>Modify behavior of other threads
</li>

<li>Enforce ordering of communicating instructions, others do not
matter
</li>
</ul>
</section>
<section id="sec-2-3" >

<h3>Deterministic Shared Multiprocessing</h3>
<ul class="org-ul">
<li>Dynamic run-time enforcement of determinism
</li>

<li>Guarantees deterministic ordering of all shared memory accesses
for a given input.
</li>

<li>Works on arbitrary code
</li>

<li>Aims to do so without sacrificing performance
</li>
</ul>
</section>
<section id="sec-2-4" >

<h3>How does it work?</h3>
<ul class="org-ul">
<li>Execute non-communicating instructions during parallel mode

<ul class="org-ul">
<li>Recover parallelism
</li>

<li>Without interthread communication, thread interleaving does not
affect program output
</li>
</ul>
</li>

<li>Serialize execution during interthread communication
</li>
</ul>

<hr  />

<img src="./images/quantum.png" alt="quantum.png" height="200%," width="200%" />

<aside class="notes">
<p>
Thread given # of instructions to execute per quantum
Threads allowed to execute in parallel until they attempt to communicate via a communicating instruction
Communicating instruction delayed until serial mode
Remainder of quantum budget executed in serial mode
</p>
</aside>
</section>
<section id="sec-2-5" >

<h3>Ownership Table</h3>
<ul class="org-ul">
<li>Used to detect communicating instructions
</li>

<li>Track ownership information for each memory location

<ul class="org-ul">
<li>Private - accessible only to owner
</li>

<li>Shared - read-only by everyone
</li>
</ul>
</li>

<li>Access unrestricted in serial mode
</li>

<li>Granularity - byte, word, page, etc.
</li>
</ul>

<hr  />

<img src="./images/ownershippolicy.png" alt="ownershippolicy.png" height="200%," width="200%" />

<aside class="notes">
<p>
-consult ownership table before each load/store instruction
-defer interthread comm. Via comm. Instr. Until serial mode
-changes to ownership table happen only in serial mode
</p>
</aside>
</section>
<section id="sec-2-6" >

<h3>Ownership Graph</h3>
<p>
<i>solid <code>= proceed immediately, dotted =</code> block until serial mode</i>
</p>

<img src="./images/ownership-graph.png" alt="ownership-graph.png" />
</section>
<section id="sec-2-7" >

<h3>Previous DMP Implementations</h3>
<ul class="org-ul">
<li>CoreDet - DMP in software

<ul class="org-ul">
<li>Modified LLVM compiler instruments load/store instructions
</li>

<li>Arbitrary <code>C</code> / <code>C++</code> code
</li>

<li>Linked with run-time framework
</li>

<li>Ownership table stored in shared memory
</li>

<li>Reduced serial mode
</li>
</ul>
</li>

<li><b>Results:</b> Average slowdown of 110% - 600%
</li>

<li>Good enough for debugging, maybe for deployment!
</li>
</ul>
</section>
<section id="sec-2-8" >

<h3>DMP Summary</h3>
<ul class="org-ul">
<li>Execute arbitrary code deterministically
</li>

<li>Deterministic ordering of communicating instructions
</li>

<li>Detect interthread communication in parallel mode, defer until
serial mode
</li>

<li>Ownership table used to detect communicating instructions
</li>
</ul>
</section>
<section id="sec-2-9" >

<h3>maTe - a Java-like programming language</h3>
<ol class="org-ol">
<li>Pure OO programming language
</li>

<li>Executed in virtual machine
</li>

<li>Grammar, instruction set and machine architecture heavily based
on Java
</li>

<li>Single-threaded
</li>
</ol>
</section>
<section id="sec-2-10" >

<h3>Architecture</h3>
<img src="./images/vm-arch.png" alt="vm-arch.png" />

<aside class="notes">
<p>
-references only == no pointers
-method frames totally private
-private <code>= good =</code> no need to instrument
-other frames inaccessible to other frames or threads
-no global variables â€“ object graph traversed using object fields
</p>
</aside>
</section>
<section id="sec-2-11" >

<h3>maTe instruction set</h3>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides" width="100%">


<colgroup>
<col  class="left" />

<col  class="left" />
</colgroup>
<tbody>
<tr>
<td class="left"><code>aconst_null</code></td>
<td class="left"><code>invokespecial</code></td>
</tr>

<tr>
<td class="left"><code>aload</code></td>
<td class="left"><code>invokenative</code></td>
</tr>

<tr>
<td class="left"><code>areturn</code></td>
<td class="left"><code>invokevirtual</code></td>
</tr>

<tr>
<td class="left"><code>astore</code></td>
<td class="left"><code>new</code></td>
</tr>

<tr>
<td class="left"><code>checkcast</code></td>
<td class="left"><code>newint</code></td>
</tr>

<tr>
<td class="left"><code>dup</code></td>
<td class="left"><code>newstr</code></td>
</tr>

<tr>
<td class="left"><code>getfield</code></td>
<td class="left"><code>out</code></td>
</tr>

<tr>
<td class="left"><code>goto</code></td>
<td class="left"><code>putfield</code></td>
</tr>

<tr>
<td class="left"><code>ifeq</code></td>
<td class="left"><code>refcmp</code></td>
</tr>

<tr>
<td class="left"><code>in</code></td>
<td class="left"><code>return</code></td>
</tr>
</tbody>
</table>

<aside class="notes">
<p>
Only two instructions can cause interthread communication
Other instructions work on private op stack/local variable arrays
</p>
</aside>
</section>
<section id="sec-2-12" >

<h3>maTe instruction set</h3>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides" width="100%">


<colgroup>
<col  class="left" />

<col  class="left" />
</colgroup>
<tbody>
<tr>
<td class="left"><code>aconst_null</code></td>
<td class="left"><code>invokespecial</code></td>
</tr>

<tr>
<td class="left"><code>aload</code></td>
<td class="left"><code>invokenative</code></td>
</tr>

<tr>
<td class="left"><code>areturn</code></td>
<td class="left"><code>invokevirtual</code></td>
</tr>

<tr>
<td class="left"><code>astore</code></td>
<td class="left"><code>new</code></td>
</tr>

<tr>
<td class="left"><code>checkcast</code></td>
<td class="left"><code>newint</code></td>
</tr>

<tr>
<td class="left"><code>dup</code></td>
<td class="left"><code>newstr</code></td>
</tr>

<tr>
<td class="left"><b><code>getfield</code></b></td>
<td class="left"><code>out</code></td>
</tr>

<tr>
<td class="left"><code>goto</code></td>
<td class="left"><b><code>putfield</code></b></td>
</tr>

<tr>
<td class="left"><code>ifeq</code></td>
<td class="left"><code>refcmp</code></td>
</tr>

<tr>
<td class="left"><code>in</code></td>
<td class="left"><code>return</code></td>
</tr>
</tbody>
</table>
</section>
<section id="sec-2-13" >

<h3>Ownership Depth</h3>
<img src="./images/depth.png" alt="depth.png" />
</section>
<section id="sec-3" >

<h2>Implementation</h2>
<ul class="org-ul">
<li>Compiler Changes
</li>

<li>Virtual Machine Changes
</li>
</ul>

</section>
<section id="sec-3-1" >

<h3>Compiler Changes</h3>
</section>
<section id="sec-3-1-1" >

<h4><code>Real</code> class (<code>float</code> wrapper)</h4>
<div class="org-src-container">

<pre class="src src-java"><span style="color: #eee8aa;">class</span> <span style="color: #00ff00;">Real</span> <span style="color: #eee8aa;">extends</span> <span style="color: #00ff00;">Object</span> {
        <span style="color: #eee8aa;">native</span> Real();
        <span style="color: #eee8aa;">native</span> Real(<span style="color: #00ff00;">Real</span> <span style="color: #8fbc8f;">r</span>);
        <span style="color: #eee8aa;">native</span> Real(<span style="color: #00ff00;">Integer</span> <span style="color: #8fbc8f;">i</span>);
        <span style="color: #eee8aa;">native</span> <span style="color: #00ff00;">Real</span> <span style="color: #9acd32;">add</span>(<span style="color: #00ff00;">Real</span> <span style="color: #8fbc8f;">r</span>);
        <span style="color: #eee8aa;">native</span> <span style="color: #00ff00;">Real</span> <span style="color: #9acd32;">subtract</span>(<span style="color: #00ff00;">Real</span> <span style="color: #8fbc8f;">r</span>);
        <span style="color: #eee8aa;">native</span> <span style="color: #00ff00;">Real</span> <span style="color: #9acd32;">multiply</span>(<span style="color: #00ff00;">Real</span> <span style="color: #8fbc8f;">r</span>);
        <span style="color: #eee8aa;">native</span> <span style="color: #00ff00;">Real</span> <span style="color: #9acd32;">divide</span>(<span style="color: #00ff00;">Real</span> <span style="color: #8fbc8f;">r</span>);
        <span style="color: #eee8aa;">native</span> <span style="color: #00ff00;">Real</span> <span style="color: #9acd32;">greaterThan</span>(<span style="color: #00ff00;">Real</span> <span style="color: #8fbc8f;">r</span>);
        <span style="color: #eee8aa;">native</span> <span style="color: #00ff00;">Real</span> <span style="color: #9acd32;">lessThan</span>(<span style="color: #00ff00;">Real</span> <span style="color: #8fbc8f;">r</span>);
        <span style="color: #eee8aa;">native</span> <span style="color: #00ff00;">Real</span> <span style="color: #9acd32;">greaterThanEqual</span>(<span style="color: #00ff00;">Real</span> <span style="color: #8fbc8f;">r</span>);
        <span style="color: #eee8aa;">native</span> <span style="color: #00ff00;">Real</span> <span style="color: #9acd32;">lessThanEqual</span>(<span style="color: #00ff00;">Real</span> <span style="color: #8fbc8f;">r</span>);
        <span style="color: #eee8aa;">native</span> <span style="color: #00ff00;">Integer</span> <span style="color: #9acd32;">not</span>();
        <span style="color: #eee8aa;">native</span> <span style="color: #00ff00;">Real</span> <span style="color: #9acd32;">minus</span>();
        <span style="color: #eee8aa;">native</span> <span style="color: #00ff00;">Real</span> <span style="color: #9acd32;">operator</span> + (<span style="color: #00ff00;">Real</span> <span style="color: #8fbc8f;">r</span>);
        <span style="color: #eee8aa;">native</span> <span style="color: #00ff00;">Real</span> <span style="color: #9acd32;">operator</span> - (<span style="color: #00ff00;">Real</span> <span style="color: #8fbc8f;">r</span>);
        <span style="color: #eee8aa;">native</span> <span style="color: #00ff00;">Real</span> <span style="color: #9acd32;">operator</span> * (<span style="color: #00ff00;">Real</span> <span style="color: #8fbc8f;">r</span>);
        <span style="color: #eee8aa;">native</span> <span style="color: #00ff00;">Real</span> <span style="color: #9acd32;">operator</span> / (<span style="color: #00ff00;">Real</span> <span style="color: #8fbc8f;">r</span>);
        <span style="color: #eee8aa;">native</span> <span style="color: #00ff00;">Integer</span> <span style="color: #9acd32;">operator</span> &gt; (<span style="color: #00ff00;">Real</span> <span style="color: #8fbc8f;">r</span>);
        <span style="color: #eee8aa;">native</span> <span style="color: #00ff00;">Integer</span> <span style="color: #9acd32;">operator</span> &lt; (<span style="color: #00ff00;">Real</span> <span style="color: #8fbc8f;">r</span>);
        <span style="color: #eee8aa;">native</span> <span style="color: #00ff00;">Integer</span> <span style="color: #8fbc8f;">operator</span> &gt;= (<span style="color: #00ff00;">Real</span> <span style="color: #8fbc8f;">r</span>);  
        <span style="color: #eee8aa;">native</span> <span style="color: #00ff00;">Integer</span> <span style="color: #8fbc8f;">operator</span> &lt;= (<span style="color: #00ff00;">Real</span> <span style="color: #8fbc8f;">r</span>);  
        <span style="color: #eee8aa;">native</span> <span style="color: #00ff00;">Integer</span> <span style="color: #9acd32;">operator</span> ! ();
        <span style="color: #eee8aa;">native</span> <span style="color: #00ff00;">Real</span> <span style="color: #9acd32;">operator</span> - ();
        <span style="color: #eee8aa;">native</span> <span style="color: #00ff00;">Integer</span> <span style="color: #9acd32;">equals</span>(<span style="color: #00ff00;">Object</span> <span style="color: #8fbc8f;">obj</span>);
        <span style="color: #eee8aa;">native</span> <span style="color: #00ff00;">Integer</span> <span style="color: #9acd32;">hashCode</span>();
        <span style="color: #eee8aa;">native</span> <span style="color: #00ff00;">String</span> <span style="color: #9acd32;">toString</span>();
        <span style="color: #eee8aa;">native</span> <span style="color: #00ff00;">Real</span> <span style="color: #9acd32;">squareRoot</span>();
}
</pre>
</div>
</section>
<section id="sec-3-1-2" >

<h4><code>synchronized</code> blocks</h4>
<div class="org-src-container">

<pre class="src src-java"><span style="color: #eee8aa;">for</span> (i = 0; i &lt; 10; i = i + 1) {
        <span style="color: #eee8aa;">synchronized</span> (obj) {
                <span style="color: #eee8aa;">if</span> (obj.field != <span style="color: #7fffd4;">null</span>) <span style="color: #eee8aa;">return</span> obj.field;
        }
}
</pre>
</div>

<hr  />

<ul class="org-ul">
<li>Use new <code>monitorenter</code> / <code>monitorexit</code> instructions
</li>

<li>Monitor stack ensures necessary <code>monitorexit</code> instructions are
emitted for all execution paths.
</li>
</ul>
</section>
<section id="sec-3-1-3" >

<h4><code>Thread</code> class</h4>
<div class="org-src-container">

<pre class="src src-java"><span style="color: #eee8aa;">class</span> <span style="color: #00ff00;">Thread</span> <span style="color: #eee8aa;">extends</span> <span style="color: #00ff00;">Object</span> {
        <span style="color: #eee8aa;">native</span> Thread();
        <span style="color: #eee8aa;">native</span> <span style="color: #00ff00;">Object</span> <span style="color: #9acd32;">start</span>();  <span style="color: #cd5c5c;">// </span><span style="color: #cd5c5c;">begin execution of run()</span>
        <span style="color: #eee8aa;">native</span> <span style="color: #00ff00;">Object</span> <span style="color: #9acd32;">run</span>();    <span style="color: #cd5c5c;">// </span><span style="color: #cd5c5c;">overridden by subclass</span>
        <span style="color: #eee8aa;">native</span> <span style="color: #00ff00;">Object</span> <span style="color: #9acd32;">join</span>();
        <span style="color: #eee8aa;">native</span> <span style="color: #00ff00;">Object</span> <span style="color: #9acd32;">sleep</span>(<span style="color: #00ff00;">Integer</span> <span style="color: #8fbc8f;">millisec</span>);  
}
</pre>
</div>

<hr  />

<ul class="org-ul">
<li>Java-based threading model
</li>
</ul>
</section>
<section id="sec-3-1-4" >

<h4><code>Object</code> class <code>wait</code> / <code>notify</code> methods</h4>
<div class="org-src-container">

<pre class="src src-java"><span style="color: #eee8aa;">class</span> <span style="color: #00ff00;">Object</span> {
        <span style="color: #eee8aa;">native</span> <span style="color: #00ff00;">Object</span> <span style="color: #9acd32;">notify</span>();
        <span style="color: #eee8aa;">native</span> <span style="color: #00ff00;">Object</span> <span style="color: #9acd32;">notifyAll</span>();
        <span style="color: #eee8aa;">native</span> <span style="color: #00ff00;">Object</span> <span style="color: #9acd32;">wait</span>();
        <span style="color: #eee8aa;">native</span> <span style="color: #00ff00;">Object</span> <span style="color: #9acd32;">wait</span>(<span style="color: #00ff00;">Integer</span> <span style="color: #8fbc8f;">timeout</span>);    
}
</pre>
</div>

<hr  />

<ul class="org-ul">
<li>Asynchronous events
</li>
</ul>
</section>
<section id="sec-3-2" >

<h3>Compiler Changes</h3>
<p>
(aka things you take for granted)
</p>

<hr  />

<ul class="org-ul">
<li><code>for</code> loops
</li>
</ul>

<div class="org-src-container">

<pre class="src src-java"><span style="color: #eee8aa;">for</span> (i = 0; i &lt; 10; i = i + 1) { ... }
</pre>
</div>

<ul class="org-ul">
<li>Boolean <code>&amp;&amp;</code> and <code>||</code> operators
</li>
</ul>

<div class="org-src-container">

<pre class="src src-java"><span style="color: #eee8aa;">if</span> ((a &amp;&amp; b) || (c &amp;&amp; d)) { ... }
</pre>
</div>

<ul class="org-ul">
<li><code>!=</code>, <code>&lt;=</code> and <code>&gt;=</code> operators
</li>
</ul>

<div class="org-src-container">

<pre class="src src-java"><span style="color: #eee8aa;">if</span> (a != b) { ... }
<span style="color: #eee8aa;">if</span> (a &lt;= b) { ... }
<span style="color: #eee8aa;">if</span> (a &gt;= b) { ... }
</pre>
</div>
</section>
<section id="sec-3-3" >

<h3>Virtual Machine Changes</h3>
</section>
<section id="sec-3-3-1" >

<h4>Multithreaded Architecture</h4>
<img src="./images/vm-arch-mt.png" alt="vm-arch-mt.png" />

<aside class="notes">
<p>
-Each thread is allocated its own PC register and VM stack
-Share same heap
</p>
</aside>
</section>
<section id="sec-3-3-2" >

<h4>Implementing Threads</h4>
<ul class="org-ul">
<li>Each <code>Thread</code> gets its own PC register &amp; VM stack
</li>

<li>Use <code>pthreads</code> threading library
</li>

<li>Use <code>pthreads_mutex_t</code> for object monitors
</li>
</ul>
</section>
<section id="sec-3-3-3" >

<h4>Threading Performance Enhancements</h4>
<ul class="org-ul">
<li>Remove lots of locks
</li>

<li>Reduce heap accesses
</li>

<li><code>Integer</code> / <code>String</code> cache
</li>

<li>Per-thread object reference / free object cache
</li>
</ul>

<aside class="notes">
<p>
First 65,536 integer values
All Strings created by <code>newstr</code> instruction
Free object cache in hash keyed on object size
</p>
</aside>
</section>
<section id="sec-3-3-4" >

<h4>Implementing DMP in maTe</h4>
<ul class="org-ul">
<li>Control execution of threads
</li>

<li>Instrument <code>getfield</code> / <code>putfield</code> instructions
</li>

<li>Track owner of each object
</li>

<li>Prevent blocking system calls
</li>
</ul>
</section>
<section id="sec-3-3-5" >

<h4>Design Goals</h4>
<ul class="org-ul">
<li>Enable/disable without recompiling

<div class="org-src-container">

<pre class="src src-sh">mvm myclass.class;    <span style="color: #cd5c5c;"># </span><span style="color: #cd5c5c;">DMP disabled</span>
mvm -p myclass.class; <span style="color: #cd5c5c;"># </span><span style="color: #cd5c5c;">DMP enabled</span>
</pre>
</div>
</li>

<li>Minimize performance penalty when disabled
</li>

<li>Allow object- or thread-specific behavior
</li>

<li>Compile DMP code out of virtual machine

<div class="org-src-container">

<pre class="src src-sh">./configure --enable-dmp=no &amp;&amp; make &amp;&amp; sudo make install;
mvm -p myclass.class;      <span style="color: #cd5c5c;"># </span><span style="color: #cd5c5c;">-p = DMP enabled</span>
Invalid switch option <span style="color: #ffa500;">'p'</span>
</pre>
</div>
</li>
</ul>
</section>
<section id="sec-3-3-6" >

<h4>Design</h4>
<ul class="org-ul">
<li>Global <code>dmp</code> module.
</li>

<li>DMP-specific modules for <code>object</code>, <code>thread</code>, <code>nlock</code> (object
monitor) and <code>table</code>.
</li>
</ul>
</section>
<section id="sec-3-3-7" >

<h4>Global <code>dmp</code> module</h4>
<ul class="org-ul"><li class="fragment none">Maintain thread set in creation order<br/><div class="org-src-container">

<pre class="src src-c"><span style="color: #00ff00;">int</span> <span style="color: #9acd32;">dmp_add_thread</span>(<span style="color: #eee8aa;">struct</span> <span style="color: #00ff00;">dmp</span> *<span style="color: #8fbc8f;">d</span>, <span style="color: #00ff00;">int</span> <span style="color: #8fbc8f;">r</span>);    <span style="color: #cd5c5c;">/* </span><span style="color: #cd5c5c;">called when Thread.start() begins </span><span style="color: #cd5c5c;">*/</span>
<span style="color: #00ff00;">int</span> <span style="color: #9acd32;">dmp_remove_thread</span>(<span style="color: #eee8aa;">struct</span> <span style="color: #00ff00;">dmp</span> *<span style="color: #8fbc8f;">d</span>, <span style="color: #00ff00;">int</span> <span style="color: #8fbc8f;">r</span>); <span style="color: #cd5c5c;">/* </span><span style="color: #cd5c5c;">called when Thread.run() terminates </span><span style="color: #cd5c5c;">*/</span>
</pre>
</div>
</li>
<li class="fragment none">Control thread execution<br/><ul class="org-ul">
<li>Block threads at end their serial/parallel segment
</li>

<li>Wake each thread in creation order during serial mode
</li>
</ul>

<div class="org-src-container">

<pre class="src src-c"><span style="color: #00ff00;">int</span> <span style="color: #9acd32;">dmp_thread_block</span>(<span style="color: #eee8aa;">struct</span> <span style="color: #00ff00;">dmp</span> *<span style="color: #8fbc8f;">d</span>, <span style="color: #eee8aa;">struct</span> <span style="color: #00ff00;">thread_dmp</span> *<span style="color: #8fbc8f;">td</span>); <span style="color: #cd5c5c;">/* </span><span style="color: #cd5c5c;">called by thread at end of segment </span><span style="color: #cd5c5c;">*/</span>
</pre>
</div>
</li>
<li class="fragment none">Implements default ownership table policy<br/><ul class="org-ul">
<li>Indicate if thread can proceed immediately with load/store or
must block until serial mode
</li>

<li>Indicate if ownership of object should be changed and how
</li>
</ul>

<div class="org-src-container">

<pre class="src src-c"><span style="color: #cd5c5c;">/* </span><span style="color: #cd5c5c;">takes current owner ID accessing thread ID</span>
<span style="color: #cd5c5c;"> * returns thread action (proceed/block) and owner action (shared/private/none)</span>
<span style="color: #cd5c5c;"> </span><span style="color: #cd5c5c;">*/</span>
<span style="color: #00ff00;">int</span> <span style="color: #9acd32;">dmp_shm_read</span>(<span style="color: #eee8aa;">struct</span> <span style="color: #00ff00;">dmp</span> *<span style="color: #8fbc8f;">d</span>, <span style="color: #00ff00;">int</span> <span style="color: #8fbc8f;">c</span>, <span style="color: #00ff00;">int</span> <span style="color: #8fbc8f;">r</span>, <span style="color: #eee8aa;">enum</span> <span style="color: #00ff00;">dmp_thread_action</span> *<span style="color: #8fbc8f;">ta</span>, <span style="color: #eee8aa;">enum</span> <span style="color: #00ff00;">dmp_owner_action</span> *<span style="color: #8fbc8f;">oa</span>);
<span style="color: #00ff00;">int</span> <span style="color: #9acd32;">dmp_shm_write</span>(<span style="color: #eee8aa;">struct</span> <span style="color: #00ff00;">dmp</span> *<span style="color: #8fbc8f;">d</span>, <span style="color: #00ff00;">int</span> <span style="color: #8fbc8f;">c</span>, <span style="color: #00ff00;">int</span> <span style="color: #8fbc8f;">r</span>, <span style="color: #eee8aa;">enum</span> <span style="color: #00ff00;">dmp_thread_action</span> *<span style="color: #8fbc8f;">ta</span>, <span style="color: #eee8aa;">enum</span> <span style="color: #00ff00;">dmp_owner_action</span> *<span style="color: #8fbc8f;">oa</span>);
</pre>
</div>

<aside class="notes">
<p>
Before allowing a \(getfield\) or \(putfield\) to actually read/write
an object's field, the DMP-specific \(object\) module passes in the
ID of the object it is going to access.  The \(dmp\) module returns
a \(thread\) action (\(block\) or \(proceed\)) and an \(owner\) action
(\(none\), \(set shared\) or \(set private\)) to perform.
</p>
</aside>
</li></ul>
</section>
<section id="sec-3-3-8" >

<h4>DMP-specific modules</h4>
<ul class="org-ul">
<li><code>object</code>, <code>thread</code>, <code>table</code> and <code>nlock</code> instances store pointer
to DMP-specific module instance
</li>
</ul>

<div class="org-src-container">

<pre class="src src-c"><span style="color: #00ff00;">int</span> <span style="color: #9acd32;">object_create</span>(<span style="color: #eee8aa;">struct</span> <span style="color: #00ff00;">class</span> *<span style="color: #8fbc8f;">c</span>, <span style="color: #00ff00;">uint32_t</span> <span style="color: #8fbc8f;">n</span>, <span style="color: #eee8aa;">struct</span> <span style="color: #00ff00;">object</span> **<span style="color: #8fbc8f;">o</span>) {
<span style="color: #7fffd4;">#ifdef</span> DMP
        <span style="color: #eee8aa;">if</span> (dmp == <span style="color: #7fffd4;">NULL</span>)
                object-&gt;dmp = <span style="color: #7fffd4;">NULL</span>;
        <span style="color: #eee8aa;">else</span>
                object-&gt;dmp = dmp_create_object_dmp(dmp, object);
<span style="color: #7fffd4;">#endif</span>
}
</pre>
</div>

<ul class="org-ul">
<li>Without DMP, performance penalty is <code>dmp</code> pointer field and
extra pointer comparisons
</li>
</ul>

<div class="org-src-container">

<pre class="src src-c"><span style="color: #00ff00;">int</span> <span style="color: #9acd32;">object_load_field</span>(<span style="color: #eee8aa;">struct</span> <span style="color: #00ff00;">object</span> *<span style="color: #8fbc8f;">o</span>, <span style="color: #00ff00;">int</span> <span style="color: #8fbc8f;">i</span>) {
<span style="color: #7fffd4;">#ifdef</span> DMP
        <span style="color: #eee8aa;">if</span> (o-&gt;dmp != <span style="color: #7fffd4;">NULL</span>)
                object_dmp_load(o-&gt;dmp, i);
<span style="color: #7fffd4;">#endif</span>

        <span style="color: #eee8aa;">return</span> o-&gt;fields[i];
}
</pre>
</div>
</section>
<section id="sec-3-3-9" >

<h4>DMP-specific modules cont'd.</h4>
<ul class="org-ul">
<li>Each instance given an attributes record
</li>

<li>Attributes contain operations table implementing DMP operations
for that module
</li>

<li>Attributes could be made object- or thread-specific
</li>
</ul>

<aside class="notes">
<p>
NULL pointer == perform default operation
</p>
</aside>
</section>
<section id="sec-3-3-10" >

<h4>Object DMP</h4>
<ul class="org-ul">
<li>Detect communicating <code>getfield</code> / <code>putfield</code> instructions
</li>

<li>Proceed or block thread and change <code>owner</code> attribute after
consulting <code>dmp_shm_read</code> / <code>dmp_shm_write</code>
</li>
</ul>

<div class="org-src-container">

<pre class="src src-c"><span style="color: #eee8aa;">struct</span> <span style="color: #00ff00;">object_dmp_ops</span> {
        <span style="color: #00ff00;">int</span>  (*<span style="color: #9acd32;">load</span>)(<span style="color: #eee8aa;">struct</span> <span style="color: #00ff00;">object_dmp</span> *<span style="color: #8fbc8f;">od</span>, <span style="color: #00ff00;">int</span> <span style="color: #8fbc8f;">i</span>);        <span style="color: #cd5c5c;">/* </span><span style="color: #cd5c5c;">called inside getfield </span><span style="color: #cd5c5c;">*/</span>
        <span style="color: #00ff00;">int</span> (*<span style="color: #9acd32;">store</span>)(<span style="color: #eee8aa;">struct</span> <span style="color: #00ff00;">object_dmp</span> *<span style="color: #8fbc8f;">od</span>, <span style="color: #00ff00;">int</span> <span style="color: #8fbc8f;">i</span>, <span style="color: #00ff00;">int</span> <span style="color: #8fbc8f;">r</span>); <span style="color: #cd5c5c;">/* </span><span style="color: #cd5c5c;">called inside putfield </span><span style="color: #cd5c5c;">*/</span>
        <span style="color: #00ff00;">int</span> (*<span style="color: #9acd32;">chown</span>)(<span style="color: #eee8aa;">struct</span> <span style="color: #00ff00;">object_dmp</span> *<span style="color: #8fbc8f;">od</span>, <span style="color: #00ff00;">int</span> <span style="color: #8fbc8f;">n</span>);        <span style="color: #cd5c5c;">/* </span><span style="color: #cd5c5c;">change object owner </span><span style="color: #cd5c5c;">*/</span>
};

<span style="color: #eee8aa;">struct</span> <span style="color: #00ff00;">object_dmp_attr</span> {
        <span style="color: #00ff00;">int</span> <span style="color: #8fbc8f;">owner</span>;              <span style="color: #cd5c5c;">/* </span><span style="color: #cd5c5c;">current owner ID, 0 == shared </span><span style="color: #cd5c5c;">*/</span>
        <span style="color: #00ff00;">int</span> <span style="color: #8fbc8f;">depth</span>;              <span style="color: #cd5c5c;">/* </span><span style="color: #cd5c5c;">ownership depth used by chown() </span><span style="color: #cd5c5c;">*/</span>
        <span style="color: #eee8aa;">struct</span> <span style="color: #00ff00;">object_dmp_ops</span> *<span style="color: #8fbc8f;">ops</span>;
};
</pre>
</div>
</section>
<section id="sec-3-3-11" >

<h4>Thread DMP</h4>
<ul class="org-ul">
<li>Handle thread creation/destruction
</li>

<li>Add/remove <code>thread</code> from <code>dmp</code> module with <code>dmp_add_thread</code> /
      <code>dmp_remove_thread</code>
</li>

<li>Increment <code>thread</code> quantum instruction counter, block with
      <code>dmp_thread_block</code> when quantum in finished
</li>

<li>Use non-blocking <code>join</code> / <code>sleep</code> implementations
</li>
</ul>

<div class="org-src-container">

<pre class="src src-c"><span style="color: #eee8aa;">struct</span> <span style="color: #00ff00;">thread_dmp_ops</span> {
        <span style="color: #00ff00;">int</span>  (*<span style="color: #9acd32;">thread_creation</span>)(<span style="color: #eee8aa;">struct</span> <span style="color: #00ff00;">thread_dmp</span> *<span style="color: #8fbc8f;">td</span>);                 <span style="color: #cd5c5c;">/* </span><span style="color: #cd5c5c;">called in Thread.start() </span><span style="color: #cd5c5c;">*/</span>
        <span style="color: #00ff00;">int</span>  (*<span style="color: #9acd32;">thread_start</span>)(<span style="color: #eee8aa;">struct</span> <span style="color: #00ff00;">thread_dmp</span> *<span style="color: #8fbc8f;">td</span>);                    <span style="color: #cd5c5c;">/* </span><span style="color: #cd5c5c;">called at top of Thread.run() </span><span style="color: #cd5c5c;">*/</span>
        <span style="color: #00ff00;">int</span>  (*<span style="color: #9acd32;">thread_destruction</span>)(<span style="color: #eee8aa;">struct</span> <span style="color: #00ff00;">thread_dmp</span> *<span style="color: #8fbc8f;">td</span>);              <span style="color: #cd5c5c;">/* </span><span style="color: #cd5c5c;">called at bottom of Thread.run() </span><span style="color: #cd5c5c;">*/</span>
        <span style="color: #00ff00;">int</span>  (*<span style="color: #9acd32;">thread_join</span>)(<span style="color: #eee8aa;">struct</span> <span style="color: #00ff00;">thread_dmp</span> *<span style="color: #8fbc8f;">td</span>);                     <span style="color: #cd5c5c;">/* </span><span style="color: #cd5c5c;">called in Thread.join() </span><span style="color: #cd5c5c;">*/</span>
        <span style="color: #00ff00;">int</span>  (*<span style="color: #9acd32;">thread_sleep</span>)(<span style="color: #eee8aa;">struct</span> <span style="color: #00ff00;">thread_dmp</span> *<span style="color: #8fbc8f;">td</span>, <span style="color: #00ff00;">int32_t</span> <span style="color: #8fbc8f;">m</span>);         <span style="color: #cd5c5c;">/* </span><span style="color: #cd5c5c;">called in Thread.sleep() </span><span style="color: #cd5c5c;">*/</span>
        <span style="color: #00ff00;">int</span>  (*<span style="color: #9acd32;">execute_instruction</span>)(<span style="color: #eee8aa;">struct</span> <span style="color: #00ff00;">thread_dmp</span> *<span style="color: #8fbc8f;">td</span>, <span style="color: #00ff00;">uint32_t</span> <span style="color: #8fbc8f;">o</span>); <span style="color: #cd5c5c;">/* </span><span style="color: #cd5c5c;">called in fetch/execute cycle </span><span style="color: #cd5c5c;">*/</span>
};

<span style="color: #eee8aa;">struct</span> <span style="color: #00ff00;">thread_dmp_attr</span> {
        <span style="color: #eee8aa;">enum</span> <span style="color: #00ff00;">thread_dmp_serial_mode</span> <span style="color: #8fbc8f;">serial_mode</span>; <span style="color: #cd5c5c;">/* </span><span style="color: #cd5c5c;">full/reduced serial mode </span><span style="color: #cd5c5c;">*/</span>
        <span style="color: #00ff00;">int</span> <span style="color: #8fbc8f;">lock_count</span>;                          <span style="color: #cd5c5c;">/* </span><span style="color: #cd5c5c;"># of acquired locks, 0 == end serial segment </span><span style="color: #cd5c5c;">*/</span>
        <span style="color: #00ff00;">int</span> <span style="color: #8fbc8f;">quantum_size</span>;                        <span style="color: #cd5c5c;">/* </span><span style="color: #cd5c5c;">instructions per quantum </span><span style="color: #cd5c5c;">*/</span>
        <span style="color: #00ff00;">uint64_t</span> <span style="color: #8fbc8f;">instruction_counter</span>;            <span style="color: #cd5c5c;">/* </span><span style="color: #cd5c5c;">instructions executed in current quantum </span><span style="color: #cd5c5c;">*/</span>
        <span style="color: #eee8aa;">struct</span> <span style="color: #00ff00;">thread_dmp_ops</span> *<span style="color: #8fbc8f;">ops</span>;
};
</pre>
</div>
</section>
<section id="sec-3-3-12" >

<h4>NLock DMP (Object Monitors)</h4>
<ul class="org-ul">
<li>Use non-blocking versions of <code>pthread_mutex_t</code> functions
</li>

<li>Increment/decrement DMP-specific <code>thread</code> module's lock count
</li>
</ul>

<div class="org-src-container">

<pre class="src src-c"><span style="color: #eee8aa;">struct</span> <span style="color: #00ff00;">nlock_dmp_ops</span> {
        <span style="color: #00ff00;">int</span>  (*<span style="color: #9acd32;">lock</span>)(<span style="color: #eee8aa;">struct</span> <span style="color: #00ff00;">nlock_dmp</span> *<span style="color: #8fbc8f;">nd</span>);   <span style="color: #cd5c5c;">/* </span><span style="color: #cd5c5c;">called in monitorenter </span><span style="color: #cd5c5c;">*/</span>
        <span style="color: #00ff00;">int</span>  (*<span style="color: #9acd32;">unlock</span>)(<span style="color: #eee8aa;">struct</span> <span style="color: #00ff00;">nlock_dmp</span> *<span style="color: #8fbc8f;">nd</span>); <span style="color: #cd5c5c;">/* </span><span style="color: #cd5c5c;">called in monitorexit </span><span style="color: #cd5c5c;">*/</span>
};

<span style="color: #eee8aa;">struct</span> <span style="color: #00ff00;">nlock_dmp_attr</span> {
        <span style="color: #eee8aa;">struct</span> <span style="color: #00ff00;">nlock_dmp_ops</span> *<span style="color: #8fbc8f;">ops</span>;
};
</pre>
</div>
</section>
<section id="sec-3-3-13" >

<h4>Table DMP</h4>
<ul class="org-ul">
<li>Hash table implemented natively inside virtual machine
</li>

<li>Table key/values must be guarded as if they were actual Object fields
</li>
</ul>

<div class="org-src-container">

<pre class="src src-c"><span style="color: #eee8aa;">struct</span> <span style="color: #00ff00;">table_dmp_ops</span> {
        <span style="color: #00ff00;">int</span>  (*<span style="color: #9acd32;">load</span>)(<span style="color: #eee8aa;">struct</span> <span style="color: #00ff00;">table_dmp</span> *<span style="color: #8fbc8f;">td</span>); <span style="color: #cd5c5c;">/* </span><span style="color: #cd5c5c;">load table field </span><span style="color: #cd5c5c;">*/</span>
        <span style="color: #00ff00;">int</span> (*<span style="color: #9acd32;">store</span>)(<span style="color: #eee8aa;">struct</span> <span style="color: #00ff00;">table_dmp</span> *<span style="color: #8fbc8f;">td</span>); <span style="color: #cd5c5c;">/* </span><span style="color: #cd5c5c;">store table field </span><span style="color: #cd5c5c;">*/</span>
};

<span style="color: #eee8aa;">struct</span> <span style="color: #00ff00;">table_dmp_attr</span> {
        <span style="color: #eee8aa;">struct</span> <span style="color: #00ff00;">table_dmp_ops</span> *<span style="color: #8fbc8f;">ops</span>;
};
</pre>
</div>
</section>
<section id="sec-3-3-14" >

<h4>DMP Statistics</h4>
<ul class="org-ul">
<li>With <code>-D</code>, prints DMP-related statistics on program termination

<div class="org-src-container">

<pre class="src src-sh">Rounds:                                 9

Parallel time (seconds):         0.323777 (37.07164%)
Serial time (seconds):           0.549605 (62.92837%)
============================================================
Total time (seconds):            0.873382 (100.0%)

Max parallel segment (seconds):   0.158997
Min parallel segment (seconds):   0.000002
Avg parallel segment (seconds):   0.071304

Max serial segment (seconds):   -1.000000
Min serial segment (seconds):    0.000378
Avg serial segment (seconds):    0.201108

Reads:                              61957 (93.77620%)
Writes:                              4112 (6.22380%)
============================================================
Total:                              66069 (100.0%)

<span style="color: #9acd32;">Total</span> (shared) [?]:                 34232 (51.81250%)
<span style="color: #9acd32;">Total</span> (private mine):               31825 (48.16934%)
<span style="color: #9acd32;">Total</span> (private not mine) [*]:          12 (0.01816%)
============================================================
Total:                              66069 (100.0%)

<span style="color: #9acd32;">Reads</span> (shared):                     34224 (55.23831%)
<span style="color: #9acd32;">Reads</span> (private mine):               27721 (44.74232%)
<span style="color: #9acd32;">Reads</span> (private not mine) [*]:          12 (0.01937%)
============================================================
Total:                              61957 (100.0%)

<span style="color: #9acd32;">Writes</span> (shared) [*]:                    8 (0.19455%)
<span style="color: #9acd32;">Writes</span> (private mine):               4104 (99.80545%)
<span style="color: #9acd32;">Writes</span> (private not mine) [*]:          0 (0.00000%)
============================================================
Total:                               4112 (100.0%)

[*] Reads/writes required blocking
[?] Writes required blocking
</pre>
</div>
</li>
</ul>
</section>
<section id="sec-3-3-15" >

<h4>Garbage Collection</h4>
<ul class="org-ul">
<li>Determining when a collection cycle will occur is not
deterministic
</li>

<li>Serial collector only, run at end of serial mode when heap is
using <code>90%</code> or more of its available memory.
</li>
</ul>

<aside class="notes">
<p>
Allocations triggering a collection can occur during parallel mode
</p>
</aside>
</section>
<section id="sec-4" >

<h2>Results</h2>
</section>
<section id="sec-4-1" >

<h3>Racey</h3>
<ul class="org-ul">
<li>Deterministic stress test
</li>

<li>Ran 10,000 times for each configuration
</li>
</ul>
</section>
<section id="sec-4-2" >

<h3>Benchmarks</h3>
<ul class="org-ul">
<li>Parallel radix sort - Multithreaded radix sort of 500 random
16-bit integers
</li>

<li>Jacobi - uses the Jacobi method to simulate temperature changes
on a 20x25 plate
</li>

<li>Parallel DPLL - Multithreaded boolean satisfiability using the
DPLL algorithm
</li>
</ul>
</section>
<section id="sec-4-3" >

<h3>Parameters</h3>
<ul class="org-ul">
<li>threads - 2, 4, 8 or 16 threads
</li>

<li>quantum size - 1000, 10000, and 100000 instructions
</li>

<li>full serial mode or reduced serial mode
</li>

<li>ownership table granularity - 1, 5 and 10 depth
</li>
</ul>
</section>
<section id="sec-4-4" >

<h3>Evaluation</h3>
<ul class="org-ul">
<li>overhead - measure difference in execution time when compared to
a non-DMP virtual machine
</li>

<li>measure difference in performance when parameters are changed
</li>
</ul>

<p>
Each benchmark was run 10 times for each combination of parameters.
Run-times are averages.
</p>
</section>
<section id="sec-4-5" >

<h3>Radix</h3>
<ul class="org-ul">
<li>No synchronized blocks in implementation, threads operate on
disjoint indexes of shared table
</li>

<li>Average overhead 54% - 4,520%
</li>

<li>Fastest DMP run 2.65 seconds, fastest non-DMP run 1.27 seconds
</li>

<li>Not sensitive to choice of serial mode
</li>

<li>Larger ownership depth results in worse execution times, likely
due to cost of rewriting ownership of all entries in shared table
</li>
</ul>

<aside class="notes">
<p>
It is also clear from the results that Radix does not benefit from
increasing the ownership table depth.  The runs with a depth of 1 had
an execution time faster than all the others, with runs at a depth of
10 having the worst.  One possible explanation for this is that the
object graph generated by the benchmark is not very deep.  Since
threads access shared arrays using Tables, a shallow object graph and
a large ownership depth could lead to threads continuously acquiring
ownership of a large percentage of the total object graph during
serial mode.  This situation could cause greatly increase the number
of blocking reads/writes during parallel mode.
</p>

<p>
At first it would seem this is borne out by the results, which show
the percentage of execution time spent in serial mode increasing from
\(50\%\) with \(-Q1000 -g1\) to \(95\%\) with \(-Q1000 -g5\) up to \(97\%\) with
\(-Q1000 -g10\).  However, upon closer inspection the total number of
blocking reads/writes actually went down from around \(5600\) with
\(-Q1000 -g1\) to around \(4000\) with \(-Q1000 -g5\) and finally around
\(3900\) with \(-Q1000 -g10\).  I believe the true reason for the slowdown
is simply the time expense of traversing the object graph while
changing an object's owner during serial mode and not an increase in
future blocking reads/writes caused by changing the object's owner.
</p>
</aside>
</section>
<section id="sec-4-6" >

<h3>Jacobi</h3>
<ul class="org-ul">
<li>Number of threads fixed at 20
</li>

<li>Average overhead 27% - 1,117%
</li>

<li>Fastest DMP run 3.71 seconds, fastest non-DMP run 2.92 seconds
</li>

<li>Calculates temperature change of plate using two shared tables
</li>

<li>Clear advantage to using reduced serial mode

<ul class="org-ul">
<li>3.71 / 16.00 seconds execution time
</li>

<li>1,842 vs. 17,616 blocking reads/writes
</li>

<li>175 vs. 3,081 rounds
</li>
</ul>
</li>
</ul>

<div class="org-src-container">

<pre class="src src-java"><span style="color: #eee8aa;">class</span> <span style="color: #00ff00;">Worker</span> <span style="color: #eee8aa;">extends</span> <span style="color: #00ff00;">Thread</span> {
        <span style="color: #00ff00;">Object</span> <span style="color: #9acd32;">run</span>() {
                <span style="color: #eee8aa;">for</span> (i = 0;  i &lt; columns;  i = i + 1) {
                        <span style="color: #eee8aa;">synchronized</span> (oldp)
                                oldp.get(...);             <span style="color: #cd5c5c;">// </span><span style="color: #cd5c5c;">get old temperature</span>
                        <span style="color: #eee8aa;">synchronized</span> (newp)
                                tmp = newp.put(...);       <span style="color: #cd5c5c;">// </span><span style="color: #cd5c5c;">calculate new temperatue</span>
                        <span style="color: #eee8aa;">synchronized</span> (oldp)
                                change = oldp.get() - tmp; <span style="color: #cd5c5c;">// </span><span style="color: #cd5c5c;">calculate temperature change</span>
                }
        }
}
</pre>
</div>
</section>
<section id="sec-4-7" >

<h3>Parallel DPLL</h3>
<ul class="org-ul">
<li>Threads traverse tree of possible <code>true</code> / <code>false</code> permutations
for the problem variables, stealing from other threads when they
run out of work.
</li>

<li>Average overhead -23% to 2,789%
</li>

<li>Fastest DMP run .95 seconds, fastest non-DMP run 0.71 seconds
</li>

<li>Showcases ineffiency of maTe virtual machine
</li>

<li>Some DMP runs beat non-DMP runs by a small margin
</li>

<li>Not sensitive to ownership table depth for 2/4 threads,
but 8/16 show extreme jumps:

<ul class="org-ul">
<li>8 threads - 11.47 vs. 21.75 seconds
</li>

<li>16 threads - 21.29 vs. 176.84 seconds
</li>
</ul>
</li>
</ul>

<aside class="notes">
<p>
-2 threads - .71 seconds
-4 threads - 1.93 seconds
-8 threads - 4.06 seconds
-16 threads - 6.12 seconds
</p>
</aside>
</section>
<section id="sec-5" >

<h2>Conclusions</h2>
<ul class="org-ul">
<li><b>Results:</b> Average slowdown of 19% - 2800%
</li>

<li>Results do not back up thesis
</li>

<li>Overhead may still be acceptable for debugging
</li>

<li>There are still advantages

<ul class="org-ul">
<li>No recompiling
</li>

<li>Quickly tweak DMP parameters with command-line arguments
</li>
</ul>
</li>

<li>Implementing efficient multithreaded virtual machine is difficult
</li>

<li>Poor multithreaded performance, did not scale
</li>
</ul>

</section>
<section id="sec-5-1" >

<h3>Future Work</h3>
<ul class="org-ul">
<li>Adaptive ownership table policy
</li>

<li>Source code annotations/static analysis optimizations
</li>

<li>Improve multithreaded performance
</li>

<li>Optimize maTe compiler
</li>

<li>Longer-running benchmarks
</li>

<li>Implement DMP in real Java virtual machine
</li>
</ul>
</section>
<section id="sec-6" >

<h2>Questions?</h2>
</section>
</div>
</div>
<script src="./reveal.js/lib/js/head.min.js"></script>
<script src="./reveal.js/js/reveal.min.js"></script>
<script>

        		// Full list of configuration options available here:
        		// https://github.com/hakimel/reveal.js#configuration
        		Reveal.initialize({
        			controls: true,
        			progress: true,
        			history: true,
        			center: true,
        			rollingLinks: true,
        			keyboard: true,
        			overview: true,
        			width: 1200, // slide width
        			height: 800, // slide height
        			margin: 0.20, // slide margin
        			minScale: 0.50, // slide minimum scaling factor
        			maxScale: 2.50, // slide maximum scaling factor


        			theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
        			transition: Reveal.getQueryHash().transition || 'none', // default/cube/page/concave/zoom/linear/fade/none
        			transitionSpeed: 'default',

        			// Optional libraries used to extend on reveal.js
        			dependencies: [
        				{ src: './reveal.js/lib/js/classList.js', condition: function() { return !document.body.classList; } }
        				,{ src: './reveal.js/plugin/markdown/showdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } }
        				,{ src: './reveal.js/plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } }
        				,{ src: './reveal.js/plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } }
        				,{ src: './reveal.js/plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } }
        				,{ src: './reveal.js/plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }
        				// { src: './reveal.js/plugin/search/search.js', async: true, condition: function() { return !!document.body.classList; } }
        				// { src: './reveal.js/plugin/remotes/remotes.js', async: true, condition: function() { return !!document.body.classList; } }
         				
        			]
        		});
</script>
</body>
</html>
